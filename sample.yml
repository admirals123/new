using StackExchange.Redis; 
// ... other code ...

// Obtain a connection string template - only for getting hostname and port
var template = "<YOUR_REDIS_CACHE_NAME>.redis.cache.windows.net:6380,password=,ssl=True,abortConnect=False";

// Split the template to extract hostname and port
string[] parts = template.Split(',');
string hostname = parts[0].Split(':')[0]; 
int port = Convert.ToInt32(parts[0].Split(':')[1]); 

// Configure client options with the token credential
ConfigurationOptions options = new ConfigurationOptions
{
    EndPoints = { { hostname, port } },
    Ssl = true,   
    AbortOnConnectFail = false,
    TokenCredential = new DefaultAzureCredential() 
};

// Connect and continue as before ...
ConnectionMultiplexer redis = ConnectionMultiplexer.Connect(options);
// ... rest of your code ...
